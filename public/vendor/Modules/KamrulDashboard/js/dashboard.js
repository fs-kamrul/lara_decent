(()=>{function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(t,a){for(var r=0;r<a.length;r++){var o=a[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,(n=o.key,l=void 0,l=function(t,a){if("object"!==e(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var o=r.call(t,a||"default");if("object"!==e(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===a?String:Number)(t)}(n,"string"),"symbol"===e(l)?l:String(l)),o)}var n,l}var a={},r=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var r,o,n;return r=e,n=[{key:"loadWidget",value:function(t,r,o,n){var l=t.closest(".widget_item"),d=l.attr("id");void 0!==n&&(a[d]=n);var s=l.find("a.collapse-expand");if(!s.length||!s.hasClass("collapse")){kamruldashboard.blockUI({target:t,iconOnly:!0,overlayColor:"none"}),void 0!==o&&null!=o||(o={});var i=l.find("select[name=predefined_range]");i.length&&(o.predefined_range=i.val()),$.ajax({type:"GET",cache:!1,url:r,data:o,success:function(r){kamruldashboard.unblockUI(t),r.error?t.html('<div class="dashboard_widget_msg col-12"><p>'+r.message+"</p>"):(t.html(r.data),void 0!==n?n():a[d]&&a[d](),0!==t.find(".scroller").length&&kamruldashboard.callScroll(t.find(".scroller")),$(".equal-height").equalHeights(),e.initSortable())},error:function(e){kamruldashboard.unblockUI(t),kamruldashboard.handleError(e)}})}}},{key:"initSortable",value:function(){if($("#list_widgets").length>0){var e=document.getElementById("list_widgets");Sortable.create(e,{group:"widgets",sort:!0,delay:0,disabled:!1,store:null,animation:150,handle:".portlet-title",ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dataIdAttr:"data-id",forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,scroll:!0,scrollSensitivity:30,scrollSpeed:10,onUpdate:function(){var e=[];$.each($(".widget_item"),(function(t,a){e.push($(a).prop("id"))})),$.ajax({type:"POST",cache:!1,url:route("dashboard.update_widget_order"),data:{items:e},success:function(e){e.error?kamruldashboard.showError(e.message):kamruldashboard.showSuccess(e.message)},error:function(e){kamruldashboard.handleError(e)}})}})}}}],(o=[{key:"init",value:function(){var t=$("#list_widgets");$(document).on("click",".portlet > .portlet-title .tools > a.remove",(function(e){e.preventDefault(),$("#hide-widget-confirm-bttn").data("id",$(e.currentTarget).closest(".widget_item").prop("id")),$("#hide_widget_modal").modal("show")})),t.on("click",".page_next, .page_previous",(function(t){t.preventDefault();var a=$(t.currentTarget),r=a.prop("href");r&&e.loadWidget(a.closest(".portlet").find(".portlet-body"),r)})),t.on("change",".number_record .numb",(function(t){t.preventDefault();var a=$(t.currentTarget),r=a.closest(".number_record").find(".numb").val();!isNaN(r)&&r>0?e.loadWidget(a.closest(".portlet").find(".portlet-body"),a.closest(".widget_item").attr("data-url"),{paginate:r}):kamruldashboard.showError("Please input a number!")})),t.on("click",".btn_change_paginate",(function(e){e.preventDefault();var t=$(e.currentTarget),a=t.closest(".number_record").find(".numb"),r=parseInt(a.prop("min")||5),o=parseInt(a.prop("max")||100),n=parseInt(a.prop("step")||5),l=parseInt(a.val());t.hasClass("btn_up")?l<o&&(l+=n):t.hasClass("btn_down")&&(l-n>0?l-=n:l=n,l<r&&(l=r)),l!=parseInt(a.val())&&a.val(l).trigger("change")})),$("#hide-widget-confirm-bttn").on("click",(function(e){e.preventDefault();var t=$(e.currentTarget).data("id");$.ajax({type:"GET",cache:!1,url:route("dashboard.hide_widget",{name:t}),success:function(a){a.error?kamruldashboard.showError(a.message):($("#"+t).fadeOut(),kamruldashboard.showSuccess(a.message)),$("#hide_widget_modal").modal("hide");var r=$(e.currentTarget).closest(".portlet");$(document).hasClass("page-portlet-fullscreen")&&$(document).removeClass("page-portlet-fullscreen"),r.find("[data-bs-toggle=tooltip]").tooltip("destroy"),r.remove()},error:function(e){kamruldashboard.handleError(e)}})})),$(document).on("click",".portlet:not(.widget-load-has-callback) > .portlet-title .tools > a.reload",(function(t){t.preventDefault();var a=$(t.currentTarget);e.loadWidget(a.closest(".portlet").find(".portlet-body"),a.closest(".widget_item").attr("data-url"))})),$(document).on("click",".portlet > .portlet-title .tools > .collapse, .portlet .portlet-title .tools > .expand",(function(t){t.preventDefault();var a=$(t.currentTarget),r=a.closest(".portlet"),o=$.trim(a.data("state"));"expand"===o?(r.find(".portlet-body").removeClass("collapse").addClass("expand"),e.loadWidget(r.find(".portlet-body"),a.closest(".widget_item").attr("data-url"))):r.find(".portlet-body").removeClass("expand").addClass("collapse"),$.ajax({type:"POST",cache:!1,url:route("dashboard.edit_widget_setting_item"),data:{name:a.closest(".widget_item").prop("id"),setting_name:"state",setting_value:o},success:function(){"collapse"===o?(a.data("state","expand"),r.find(".predefined-ranges").addClass("d-none"),r.find("a.reload").addClass("d-none"),r.find("a.fullscreen").addClass("d-none")):(a.data("state","collapse"),r.find(".predefined-ranges").removeClass("d-none"),r.find("a.reload").removeClass("d-none"),r.find("a.fullscreen").removeClass("d-none"))},error:function(e){kamruldashboard.handleError(e)}})})),$(document).on("change",".portlet select[name=predefined_range]",(function(t){t.preventDefault();var a=$(t.currentTarget);e.loadWidget(a.closest(".portlet").find(".portlet-body"),a.closest(".widget_item").attr("data-url"),{changed_predefined_range:1})}));var a=$("#manage_widget_modal");$(document).on("click",".manage-widget",(function(e){e.preventDefault(),a.modal("show")})),a.on("change",".swc_wrap input",(function(e){$(e.currentTarget).closest("section").find("i").toggleClass("widget_none_color")}))}}])&&t(r.prototype,o),n&&t(r,n),Object.defineProperty(r,"prototype",{writable:!1}),e}();$(document).ready((function(){(new r).init(),window.BDashboard=r}))})();